<div class="chat-widget-container">
    <h3 class="chat-title">Chat Widget</h3>
    <div class="chat-messages" id="chatMessages"></div>
    <div class="chat-input">
        <input type="text" id="chatUsername" placeholder="Name" maxlength="15">
        <input type="text" id="chatMessage" placeholder="Message..." maxlength="100">
        <button onclick="sendMessage()">Send</button>
    </div>
</div>

<style>
  .chat-widget-container {
      width: 60%; /* Set width to 60% of the viewport */
      max-width: 90vw; /* Keep a maximum width for smaller screens */
      height: 400px;
      background-color: #1e1e1e;
      border: 1px solid #333;
      border-radius: 10px;
      padding: 16px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.6);
      display: flex;
      flex-direction: column;
      overflow: hidden;
  }

    /* Styling for the title */
    .chat-title {
        text-align: center;
        font-size: 1.2em;
        color: #f0f0f0;
        padding-bottom: 10px;
        border-bottom: 1px solid #333;
        margin-bottom: 10px;
    }

    /* Styling for the messages section */
    .chat-messages {
        flex: 1;
        overflow-y: auto;
        background-color: #2a2a2a;
        padding: 10px;
        border-radius: 6px;
        margin-bottom: 10px;
        font-size: 0.9em;
        box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.5);
    }

    /* Message styles */
    .chat-messages div {
        padding: 5px;
        border-radius: 4px;
        background: #444;
        margin-bottom: 4px;
        color: #ddd;
    }
    .chat-messages div strong {
        color: #a0c0ff;
    }

    /* Input area styling */
    .chat-input {
        display: flex;
        gap: 5px;
        margin-top: 5px;
    }

    .chat-input input[type="text"] {
        flex: 1;
        padding: 8px;
        border: none;
        border-radius: 4px;
        background-color: #333;
        color: #e0e0e0;
    }

    .chat-input input::placeholder {
        color: #aaa;
    }

    .chat-input button {
        padding: 8px 12px;
        background-color: #5a5a5a;
        color: #e0e0e0;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 1em;
        transition: background-color 0.3s ease;
    }

    .chat-input button:hover {
        background-color: #777;
    }
</style>


<script>
    async function loadMessages() {
        try {
            const response = await fetch("https://kabayan.top/chat.php");
            const messages = await response.json();
            const messagesDiv = document.getElementById("chatMessages");
            messagesDiv.innerHTML = messages.map(
                msg => `<div><strong>${msg.username}</strong>: ${msg.message}</div>`
            ).join('');
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        } catch (error) {
            console.error("Error loading messages:", error);
        }
    }

    async function sendMessage() {
        const username = document.getElementById("chatUsername").value.trim();
        const message = document.getElementById("chatMessage").value.trim();

        if (username && message) {
            try {
                await fetch("https://kabayan.top/chat.php", {
                    method: "POST",
                    headers: { "Content-Type": "application/x-www-form-urlencoded" },
                    body: `username=${encodeURIComponent(username)}&message=${encodeURIComponent(message)}`
                });
                document.getElementById("chatMessage").value = "";
                loadMessages();
            } catch (error) {
                console.error("Error sending message:", error);
            }
        }
    }

    // Load messages initially and every 5 seconds
    document.addEventListener("DOMContentLoaded", () => {
        loadMessages();
        setInterval(loadMessages, 5000);
    });
</script>
